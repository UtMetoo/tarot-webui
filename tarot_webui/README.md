# 塔罗牌占卜前端应用

## 项目简介

这是一个基于AI的塔罗牌占卜前端应用，通过调用Coze平台的API接口，为用户提供专业的塔罗牌解读服务。项目采用现代化的Web技术栈，支持部署到Vercel平台。

## 功能特性

- 🔮 **智能占卜**: 基于AI的详细塔罗牌解读和星盘分析
- 📱 **响应式设计**: 支持各种设备尺寸，移动端友好
- 🎨 **苹果风格UI**: 采用现代化的设计美学，用户体验优秀
- ⚡ **实时反馈**: 流式响应和加载动画
- 🏙️ **智能城市选择**: 支持中国主要城市的智能搜索和选择
- 📅 **标准化输入**: 标准化的生日时间与性别（下拉选择）
- 🔒 **安全性**: API密钥通过环境变量管理，避免前端暴露

## 技术架构

- **前端**: 纯HTML/CSS/JavaScript，无需构建步骤
- **后端**: Vercel Serverless Functions处理API调用
- **API**: 集成Coze平台的工作流API
- **部署**: Vercel平台，支持自动部署
- **设计**: 响应式设计，支持移动端和桌面端

## 页面设计规范

- **整体风格**: 通过有组织的层次、对比与留白提升可读性，减少无效装饰，突出关键信息。
- **色彩**: 页面主体使用渐变背景（#667EEA 到 #764BA2），分区与卡片用白色；主要按钮使用品牌色（#667EEA），次要按钮使用浅灰（#e2e8f0）；强调色用于聚焦状态与微交互。
- **层次结构**: 建议采用四层模型：页面背景 → 分区容器 → 组件卡片 → 交互状态/强调。通过轻阴影、1px 边框和背景分层体现层次，不依赖粗重描边。
- **信息权重**: 标题层级清晰（H1/H2/H3 递进），正文对比适中；次要信息用次要色/较小字号/提高透明度处理，避免与主体争抢注意力。
- **视觉引导**: 统一栅格与间距系统（建议 8/12pt 步进）；减少分割线，更多依赖组块间距与对齐来分隔信息。
- **控件**: 输入框/下拉/文本域边框 1px、白底；聚焦仅高亮描边与轻阴影，不改变布局尺寸。
  - 性别使用下拉选择；出生城市采用行内布局（标签与输入同一行）。
- **按钮**: 实心品牌色（#667EEA）、圆角 12px；悬停轻微亮度或阴影变化；禁用态降低不透明度，不改变布局。
- **卡片**: 圆角 16px、1px 边框、轻阴影；卡片之间保持足够外边距，避免内容过密。
- **动效与反馈**: 仅保留必要状态反馈（加载/成功/错误）；动效时长 150–250ms，使用 ease-out 或 ease-in-out；加载动效简洁克制。
- **移动端**: 单列堆叠，增大触控目标（≥44px），适当增大组件间距，优先保证可读性与操作容错。
- **可访问性**: 文字与背景对比度 ≥ 4.5:1，焦点可见；交互组件提供 aria-* 属性与键盘可达性。

## 项目结构

```
tarot_webui/
├── public/                 # 静态文件目录
│   ├── index.html         # 主页面
│   ├── styles.css         # 样式文件
│   └── script.js          # 前端逻辑
├── api/                   # Vercel Serverless Functions
│   ├── tarot.js          # 塔罗牌API路由处理
│   ├── auth/             # 用户认证相关API
│   │   ├── register.js   # 用户注册
│   │   ├── login.js      # 用户登录
│   │   ├── logout.js     # 用户登出
│   │   └── me.js         # 获取当前用户信息
│   └── _utils/           # 工具函数
│       ├── feishu.js     # 飞书多维表格集成
│       └── cookies.js    # 会话Cookie管理
├── package.json           # 项目依赖配置
├── vercel.json            # Vercel部署配置
├── .gitignore             # Git忽略文件
└── README.md              # 项目说明文档
```

## 本地开发

### 1. 环境准备

```bash
# 安装Node.js (推荐v18+)
# 安装Vercel CLI
npm install -g vercel
```

### 2. 项目设置

```bash
# 克隆项目
git clone <repository-url>
cd tarot_webui

# 安装依赖
npm install

# 设置环境变量
# 创建 .env.local 文件
echo "COZE_API_KEY=你的API密钥" > .env.local
echo "COZE_WORKFLOW_ID=你的工作流ID" >> .env.local
```

### 3. 本地运行

```bash
# 启动开发服务器
vercel dev
# 或者
npm run dev
```

访问 `http://localhost:3000` 查看应用

## Vercel部署

### 1. 自动部署（推荐）

1. 将代码推送到GitHub仓库
2. 在Vercel控制台连接GitHub仓库
3. 配置环境变量：
   - `COZE_API_KEY`: 你的Coze API密钥
   - `COZE_WORKFLOW_ID`: 你的工作流ID
4. 点击部署

### 2. 手动部署

```bash
# 登录Vercel
vercel login

# 部署项目
vercel

# 设置生产环境变量
vercel env add COZE_API_KEY
vercel env add COZE_WORKFLOW_ID

# 重新部署以应用环境变量
vercel --prod
```

## 使用方法

### 1. 用户操作流程

1. 打开应用网址
2. 填写个人信息：
   - 选择出生日期和时间
   - 选择性别（男/女）
   - 从下拉列表中搜索并选择出生城市
3. 输入想要占卜的问题（详细描述）
4. 点击"开始占卜"按钮
5. 等待AI解读结果（支持实时流式显示）

### 2. 城市选择功能

- 支持拼音搜索（如：输入"beijing"找到"北京市"）
- 支持中文搜索（如：输入"北京"找到"北京市"）
- 支持省份搜索（如：输入"广东"找到广东省的城市）
- 默认显示热门城市列表

### 3. 错误处理

- 表单验证：确保所有必填项已填写
- 城市验证：确保选择的城市在支持列表中
- API错误处理：网络错误或API错误时显示友好提示
- 重试机制：支持重新开始占卜

## 配置说明

### 环境变量

| 变量名 | 描述 | 示例 |
|--------|------|------|
| `COZE_API_KEY` | Coze平台API密钥 | `pat_XLlHD2busKOz...` |
| `COZE_WORKFLOW_ID` | 工作流ID | `7536640635056619572` |
| `FEISHU_APP_ID` | 飞书应用ID（用户认证） | `cli_xxx` |
| `FEISHU_APP_SECRET` | 飞书应用密钥（用户认证） | `xxx` |
| `FEISHU_BITABLE_APP_TOKEN` | 飞书多维表格应用Token | `xxx` |
| `FEISHU_BITABLE_TABLE_ID` | 飞书多维表格表ID | `xxx` |

### Vercel配置 (vercel.json)

- 静态文件托管：`public/` 目录下的文件
- API路由：`/api/*` 路径映射到 `api/` 目录
- 环境变量：通过Vercel控制台或CLI配置

## 开发指南

### 前端开发

- 使用原生JavaScript，无需构建工具
- 采用ES6+语法和现代Web API
- 响应式设计，支持移动端
- 遵循苹果设计规范

### API开发

- 使用Vercel Serverless Functions
- 支持流式响应处理
- 完善的错误处理和日志记录
- CORS配置支持跨域访问

### 样式开发

- 使用CSS3特性和Flexbox布局
- 支持深色/浅色主题适配
- 平滑动画和过渡效果
- 移动端优化

## 故障排除

### 常见问题

1. **API调用失败**
   - 检查环境变量是否正确配置
   - 确认Coze API密钥有效
   - 检查网络连接

2. **城市选择问题**
   - 确保从下拉列表中选择城市
   - 检查城市名称是否完整

3. **部署问题**
   - 确认vercel.json配置正确
   - 检查环境变量在生产环境中是否设置
   - 查看Vercel部署日志

### 调试方法

```bash
# 查看本地开发日志
vercel dev --debug

# 查看生产环境日志
vercel logs

# 测试API接口
curl -X POST 'https://your-app.vercel.app/api/tarot' \
  -H 'Content-Type: application/json' \
  -d '{"birthday":"1990-01-01 12:00","gender":"男","city":"北京市","question":"测试问题"}'
```

## 未来优化方向

1. **用户认证系统**: 支持用户注册、登录功能，用户凭证保存在飞书多维表格中
2. **PWA支持**: 添加Service Worker，支持离线使用
3. **历史记录**: 保存用户的占卜历史到本地存储
4. **多语言**: 支持英文等其他语言界面
5. **主题切换**: 支持深色/浅色主题切换
6. **社交分享**: 支持分享占卜结果到社交媒体
7. **数据分析**: 添加用户行为分析和统计
8. **性能优化**: 图片懒加载、缓存优化等

## 技术支持

如有问题或建议，请：

1. 查看项目代码注释
2. 检查Vercel部署日志
3. 提交GitHub Issue
4. 联系开发者

---

*基于AI的神秘智慧，探索命运的奥秘* ✨

## 许可证

MIT License - 详见 LICENSE 文件